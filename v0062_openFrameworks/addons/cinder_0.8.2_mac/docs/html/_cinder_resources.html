<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>Cinder</title>
		<link rel="stylesheet" href="cinder_doxygen.css" type="text/css" media="screen" />
		<script type="text/javascript" src="jquery-1.4.2.min.js"></script>
		<script type="text/javascript" src="jquery.lightbox-0.5.pack.js"></script>		
	</head>
<body>	
<div class="wrapper">
	<div id="header">
		<h1><a href="http://libcinder.org">Cinder</a></h1>
	</div>

<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Using Resources in Cinder </h1>  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="intro"></a>
Introduction</h2>
<p>Most applications need to reference information outside of their own code in order to do anything very interesting. This information might be in the form of images, sounds, video, XML or any other sort of data, and when these files are built-in to the application itself they are typically referred to as <em>resources</em>. In Cinder, resources are handled as transparently as possible. Adding them to your application is simple, and loading them is nearly identical to loading a normal file or URL. By using the platform-native techniques for storing resources (as opposed to say, an external <em>data</em> folder) you can ensure your application is self-contained, removing the need for installers or the possibility of users inadvertently deleting the files your app depends on.</p>
<h2><a class="anchor" id="layout"></a>
Project File Structure</h2>
<p>For both single-platform and cross-platform applications, we recommend keeping your resource files in their own directory. These files are as much a part of your app as its source code, and they'll generally be managed by your version control system (say, Subversion or git) just as your C++ code or anything else in your project is. Depicted below is how we usually structure the directories in the Cinder samples, and if you don't already have your own convention, this is probably a good one to adopt:<br/>
<br/>
 </p>
<div align="center">
<img src="resources_file_structure.png" alt="resources_file_structure.png"/>
</div>
<p> <br/>
 We'll get into the specifics of some of these files in later sections. <br/>
 </p>
<h2><a class="anchor" id="mac"></a>
Resources on Mac OS X &amp; Cocoa Touch</h2>
<p>Under Mac OS X as well as Cocoa Touch (which includes the iPhone and iPad) resources are just normal files which are contained inside the application bundle. If you haven't before, try opening up one of these bundles yourself. Simply context-click (right-click or control-click) an application in your <em>Applications</em> folder and choose <b>Show Package Contents</b>. Here's the results of doing this with iTunes:<br/>
<br/>
 </p>
<div align="center">
<img src="resources_itunes_mac_show_package.png" alt="resources_itunes_mac_show_package.png"/>
</div>
<p> <br/>
<br/>
 </p>
<div align="center">
<img src="resources_itunes_mac.png" alt="resources_itunes_mac.png"/>
</div>
<p> <br/>
 Looking around inside of the application bundle, we see a <em>Resources</em> folder inside of <em>Contents</em>. In here we can find all the data files the application depends on. As an example, the first few visible files in the screenshot are audio files iTunes plays as part of its user interface.<br/>
 <br/>
 A similar structure is maintained for iPhone and iPad apps, and it's the one Cinder uses for these platforms as well. <br/>
<br/>
 </p>
<h3><a class="anchor" id="macAdd"></a>
Adding a Resource</h3>
<p>Adding a resource to your Mac or Cocoa Touch application couldn't be easier. Let's assume you've got an image you'd like to use in your app. The first step is to add this file as a resource in Xcode. First, pull up your project window in Xcode. Now, context-click the <em>Resources</em> folder and choose <b>Add | Existing Files...</b>.<br/>
<br/>
</p>
<div align="center">
<img src="resources_mac_add_resource.png" alt="resources_mac_add_resource.png"/>
</div>
<p> <br/>
 Now select the file you'd like to add to your app from the Open dialog box that follows. After choosing your file, you'll see it listed in the <em>Resources</em> group of your Xcode project. The real magic happens though when Xcode copies these files into your application bundle at build time. To confirm that this will happen, select the <em>Targets</em> tab of your project inspector and reveal your application target under the <em>Targets</em> section. You'll see a build phase called <em>Copy Bundle Resources</em> and inside that will be the resource you've just added.<br/>
<br/>
</p>
<div align="center">
<img src="resources_mac_build_phase.png" alt="resources_mac_build_phase.png"/>
</div>
<p> <br/>
</p>
<h3><a class="anchor" id="macUse"></a>
Using a Resource</h3>
<p>Now that we've got a resource in the application, how do we actually make use of it with Cinder code? For a Mac or Cocoa Touch-only application, we simply call the <a class="el" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource()</a> function and pass it the name of the resource as a string. The result of this function (which is a <a class="el" href="classcinder_1_1_data_source.html">DataSourceRef</a>, a class you won't generally need to use directly) can be passed to most Cinder functions and constructors that know how to do I/O. In the case of our logo image example, we would call <a class="el" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource()</a> on that file and then pass it to <a class="el" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage()</a>. Then the result of <a class="el" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage()</a> can be used to create a <a class="el" href="classcinder_1_1gl_1_1_texture.html">gl::Texture</a> or a <a class="el" href="classcinder_1_1_surface_t.html">Surface</a> like so: </p>
<div class="fragment"><pre class="fragment">gl::Texture myTexture( <a class="code" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage</a>( <a class="code" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource</a>( <span class="stringliteral">&quot;Logo.jpg&quot;</span> ) ) );
<a class="code" href="namespacecinder.html#a7f62055e4cb811edb9868b32595a1d64">Surface</a> mySurface( <a class="code" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage</a>( <a class="code" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource</a>( <span class="stringliteral">&quot;Logo.jpg&quot;</span> ) ) );
</pre></div><p> or perhaps we want to create a QuickTime movie out of a resource called <em>FlyingLogo.mov:</em> </p>
<div class="fragment"><pre class="fragment">qtime::MovieGl myMovie( <a class="code" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource</a>( <span class="stringliteral">&quot;FlyingLogo.mov&quot;</span> ) );
</pre></div><p> <br/>
 Pretty easy stuff. On the Cocoa side, that's all there is to it. In general, you can make use of the results of <a class="el" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource()</a> about like you'd expect. However a handy function if you ever need to load a resource using a function which only accepts file paths is App::getResourcePath(). For example, calling this: </p>
<div class="fragment"><pre class="fragment"><a class="code" href="namespacecinder_1_1app.html#a72f7349e12a6766075862ed953868abe" title="Returns a reference to an output console, which is an alias to std::cout on the mac, and a wrapper around OutputDebugString on MSW.">console</a>() &lt;&lt; getResourcePath( <span class="stringliteral">&quot;Logo.jpg&quot;</span> ) &lt;&lt; endl;
</pre></div><p> Results in something about like this: <code>/Users/andrewfb/Code/cinder/samples/resizeTest/xcode/build/Debug/resizeTest.app/Contents/Resources/Logo.jpg</code></p>
<h2><a class="anchor" id="msw"></a>
Resources on Windows</h2>
<p>Now let's take a look now at how resources are handled on Microsoft Windows. The most noticeable difference from the Mac is that resources are not stored as individual files, since an EXE does not encapsulate a directory like a Mac OS X application bundle does. Instead, resources are baked into the EXE using a resource compiler, and are stored as binary data. However we can access this binary data in memory using the same <a class="el" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource()</a> routine we do on Mac OS X. Furthermore, Cinder's internal code is able to handle loading from either the flat file or in-memory representations transparently and efficiently, so in general you will not need to change application code between the platforms. <br/>
<br/>
 <b>Note: </b>The text which follows is helpful for understanding how Windows resources work under the hood, but we recommend you read and consider the alternative techniques under the <a class="el" href="_cinder_resources.html#xplatform">Cross-Platform Resources</a> section as well, even if you are writing Windows-only code.<br/>
 <br/>
 </p>
<h3><a class="anchor" id="mswAdd"></a>
Adding a Resource</h3>
<p>Resources under Windows are identified by a combination of integer ID numbers and a string declaring the type of resource. The integer IDs are generally numbered starting from <code>128</code> though there is some flexibility here. Developers also adopt different idioms for the type string. For example, in the Cinder samples you might see <code>GLSL</code> as the type string for any OpenGL GLSL code stored as resources. In general developers will use a series of preprocessor <code>#define</code>'s to create a list of unique IDs, and these should be defined in a header file which we typically create as <em>include\Resources.h</em>:<br/>
 <b>Resources.h</b> </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#pragma once</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define RES_LOGO_ID             128</span>
<span class="preprocessor"></span><span class="preprocessor">#define RES_SPLASHSCREEN_ID     129</span>
<span class="preprocessor">#define RES_THEME_MUSIC         130</span>
</pre></div><p> <br/>
<br/>
 Next, we will create a <em>Resources.rc</em> file, which will tell the compiler which resources we'd like to be included in our app. The structure of this file is a series of lines beginning with the unique resource ID (which we defined in <em>Resources.h</em>), then a string declaring the resource type (again, this can be anything, but it's good to adopt a convention like assigning <code>IMAGE</code> to all of your image files) and last, the file path relative to the .rc file itself. Note that these files are C-style double-quoted strings and consequently, any backslashes must be doubled to distinguish them from escaped characters. The resource compiler walks this file, baking the data of each cited resource into the final EXE. A normal <em>Resources.rc</em> file might look like this:<br/>
 <b>Resources.rc</b> </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;..\include\Resources.h&quot;</span>

RES_LOGO_ID             IMAGE           <span class="stringliteral">&quot;..\\resources\\Logo.jpg&quot;</span>
RES_SPLASHSCREEN_ID     IMAGE           <span class="stringliteral">&quot;..\\resources\\Splashscreen.png&quot;</span>
RES_THEME_MUSIC_ID      MP3             <span class="stringliteral">&quot;..\\resources\\Theme.mp3&quot;</span>
</pre></div><p> <br/>
 If it's not already part of your project, you'll need to add <em>Resources.rc</em> to your Visual C++ project. You can do this by right-clicking the <em>Resources</em> filter, choosing <b>Add | Existing Item...</b> and navigating to <em>Resources.rc</em>. Per the screenshot at the top of this document, we generally recommend storing this file in the same directory as your Visual C++ project, though that is not strictly necessary.<br/>
<br/>
 </p>
<div align="center">
<img src="resources_msw_add.png" alt="resources_msw_add.png"/>
</div>
<p> <br/>
 </p>
<h3><a class="anchor" id="mswUse"></a>
Using a Resource</h3>
<p>So now our app has its resources baked in, but how do we use them? For Windows-only applications, we call the variant of App::loadResource() which accepts our resource ID/type combination. Just like on the Mac, the result of <a class="el" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource()</a> can be passed directly to a function like <a class="el" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage()</a>. Then for example, the result of <a class="el" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage()</a> can be used to create a <a class="el" href="classcinder_1_1gl_1_1_texture.html">gl::Texture</a> or a <a class="el" href="classcinder_1_1_surface_t.html">Surface</a> like so: </p>
<div class="fragment"><pre class="fragment">gl::Texture myTexture( <a class="code" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage</a>( <a class="code" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource</a>( RES_LOGO_ID, <span class="stringliteral">&quot;IMAGE&quot;</span> ) ) );
<a class="code" href="namespacecinder.html#a7f62055e4cb811edb9868b32595a1d64">Surface</a> mySurface( <a class="code" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage</a>( <a class="code" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource</a>( RES_SPLASHSCREEN_ID, <span class="stringliteral">&quot;IMAGE&quot;</span> ) ) );
</pre></div><p> <br/>
 </p>
<h2><a class="anchor" id="xplatform"></a>
Cross-Platform Resources</h2>
<p>As we've seen, Mac OS X and Windows handle resources slightly differently, but Cinder provides some tools which can simplify these differences. The most straightforward way to use the same code on both platforms is to call the variant of <a class="el" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource()</a> which accepts both a Mac file path and a Windows ID/Type combination. Cinder will automatically pay attention to the relevant parameters for the platform you are compiling on. Calling this looks about like this: </p>
<div class="fragment"><pre class="fragment"><a class="code" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource</a>( <span class="stringliteral">&quot;Logo.jpg&quot;</span>, RES_LOGO_ID, <span class="stringliteral">&quot;IMAGE&quot;</span> );
</pre></div><p> <br/>
 However, Cinder provides some convenient capabilities which not only simplify your application code, but can consolidate the definition of the resources themselves. Let's continue the <em>Logo.jpg</em> example. We'll start with the most changed portion, which is the structure of <em>Resources.h</em> <br/>
 <b>Resources.h</b>: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#pragma once</span>
<span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="_cinder_resources_8h.html">cinder/CinderResources.h</a>&quot;</span>

<span class="preprocessor">#define RES_LOGO    CINDER_RESOURCE( ../resources/, Logo.jpg, 128, IMAGE )</span>
</pre></div><p> <br/>
 You'll notice a couple of changes. The first is the inclusion of the file <em>"cinder/CinderResources.h"</em>. This file defines the <code>CINDER_RESOURCE</code> macro, which breaks down as follows:<br/>
 <code>CINDER_RESOURCE</code>( <em>relative path to the parent of the resource</em>, <em>file name of the resource</em>, <em>Windows integer ID</em>, <em>Windows type</em> )<br/>
 <br/>
 As you can see, we use this macro to define a resource named <code>RES_LOGO</code>. Its path (relative to the <em>Resources.rc</em> file) is <code>../resources/Logo.jpg</code>, which we split into the parent and the name of the file itself with the macro. And finally, we assign our Windows ID/type combination, <code>128</code> for the ID and <code>IMAGE</code> for the type string. Should you need to define several resources, make sure each one is defined on its own line, and the last ends with a carriage return. <br/>
 <br/>
 Next, we'll look at our redefined <em>Resources.rc</em> file designed to make use of this macro:<br/>
 <b>Resources.rc:</b> </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;..\include\Resources.h&quot;</span>

RES_LOGO
</pre></div><p> <br/>
 This file has been simplified by our new <code>CINDER_RESOURCE</code> macro. We simply write the name of the resource we want included in our .exe. Make sure each resource has its own line when you have multiple resources, and don't forget the carriage return on the last line.<br/>
 <br/>
 On the Mac OS X side of things, you'll still include your resource in the <em>Resources</em> group of your Xcode project, and confirm its presence in the <em>Copy Bundle Resources</em> build phase to be safe.<br/>
 <br/>
 Finally, let's look at how our application code has changed:<br/>
 </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;Resources.h&quot;</span>
...
gl::Texture myTexture( <a class="code" href="namespacecinder.html#a5091cf493eafbd8741669dfac5188856" title="Loads an image from the file path path. Optional extension parameter allows specification of a file t...">loadImage</a>( <a class="code" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource</a>( RES_LOGO ) ) );
</pre></div><p> <br/>
 It's about the same, except now we simply pass the resource name to <a class="el" href="namespacecinder_1_1app.html#a93522b1858f745f7d9438d6d124ae11b" title="Returns a DataSource to an application resource. On Mac OS X, macPath is a path relative to the bundl...">loadResource()</a> and the right thing will happen on either platform. <br/>
 <br/>
 That's all there is to using cross-platform resources. It can be a bit of a pain to setup initially, but it's easy to maintain once you've got it going, and TinderBox should setup things appropriately automatically if you use it. And while you can use either style of resource definition, we prefer the <code>CINDER_RESOURCE</code> technique since it's less error-prone and makes for slightly more legible application code. </p>
</div>
	<div class="footer">
		<p> </p>
	</div>
</div>	
</body>
</html>
