<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>Cinder</title>
		<link rel="stylesheet" href="cinder_doxygen.css" type="text/css" media="screen" />
		<script type="text/javascript" src="jquery-1.4.2.min.js"></script>
		<script type="text/javascript" src="jquery.lightbox-0.5.pack.js"></script>		
	</head>
<body>	
<div class="wrapper">
	<div id="header">
		<h1><a href="http://libcinder.org">Cinder</a></h1>
	</div>

<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>include/cinder/Quaternion.h</h1>  </div>
</div>
<div class="contents">
<a href="_quaternion_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> Copyright (c) 2010, The Barbarian Group</span>
<a name="l00003"></a>00003 <span class="comment"> All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment"> Redistribution and use in source and binary forms, with or without modification, are permitted provided that</span>
<a name="l00006"></a>00006 <span class="comment"> the following conditions are met:</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and</span>
<a name="l00009"></a>00009 <span class="comment">    the following disclaimer.</span>
<a name="l00010"></a>00010 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and</span>
<a name="l00011"></a>00011 <span class="comment">    the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment"> THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED</span>
<a name="l00014"></a>00014 <span class="comment"> WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A</span>
<a name="l00015"></a>00015 <span class="comment"> PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR</span>
<a name="l00016"></a>00016 <span class="comment"> ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED</span>
<a name="l00017"></a>00017 <span class="comment"> TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
<a name="l00018"></a>00018 <span class="comment"> HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span>
<a name="l00019"></a>00019 <span class="comment"> NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<a name="l00020"></a>00020 <span class="comment"> POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00021"></a>00021 <span class="comment">*/</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#pragma once</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="_cinder_math_8h.html">cinder/CinderMath.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="_vector_8h.html">cinder/Vector.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="_matrix_8h.html">cinder/Matrix.h</a>&quot;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="keyword">namespace </span>cinder {
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Y&gt;
<a name="l00032"></a><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html">00032</a> <span class="keyword">struct </span><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html">QUATCONV</a> {
<a name="l00033"></a><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">00033</a>     <span class="keyword">typedef</span> <span class="keyword">typename</span> T::TYPE F;
<a name="l00034"></a><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#a6b26e66020845204204f2f523a197c0c">00034</a>     <span class="keyword">static</span> <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">F</a>    <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#a6b26e66020845204204f2f523a197c0c">getW</a>( <span class="keyword">const</span> Y &amp;v ) { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">F</a><span class="keyword">&gt;</span>( v.w ); }
<a name="l00035"></a><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae637dcd7f16785b785cf2df9feaf452a">00035</a>     <span class="keyword">static</span> <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">F</a>    <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae637dcd7f16785b785cf2df9feaf452a">getX</a>( <span class="keyword">const</span> Y &amp;v ) { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">F</a><span class="keyword">&gt;</span>( v.x ); }
<a name="l00036"></a><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#a161a5f244ff52088a68a0c37cf4e01db">00036</a>     <span class="keyword">static</span> <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">F</a>    <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#a161a5f244ff52088a68a0c37cf4e01db">getY</a>( <span class="keyword">const</span> Y &amp;v ) { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">F</a><span class="keyword">&gt;</span>( v.y ); }
<a name="l00037"></a><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#a3616d6d45d6d6d8f91f9e681ea85bba9">00037</a>     <span class="keyword">static</span> <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">F</a>    <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#a3616d6d45d6d6d8f91f9e681ea85bba9">getZ</a>( <span class="keyword">const</span> Y &amp;v ) { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html#ae356a31dd0e86c12b1042e9ab5e4f295">F</a><span class="keyword">&gt;</span>( v.z ); }
<a name="l00038"></a>00038 };
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<a name="l00041"></a><a class="code" href="classcinder_1_1_quaternion.html">00041</a> <span class="keyword">class </span><a class="code" href="classcinder_1_1_quaternion.html">Quaternion</a>
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043  <span class="keyword">public</span>:
<a name="l00044"></a><a class="code" href="classcinder_1_1_quaternion.html#ad62edd045ae9eb51c029fbdc7bca81b8">00044</a>     <span class="keyword">typedef</span> T TYPE;
<a name="l00045"></a>00045  
<a name="l00046"></a><a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">00046</a>     <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>     <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>; <span class="comment">// axisOfRotation.normalized() * sin( angleOfRotation / 2 )</span>
<a name="l00047"></a><a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">00047</a>     T           <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>; <span class="comment">// cos( angleOfRotation / 2 )</span>
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="classcinder_1_1_quaternion.html#a6ba7cef405bde4bc871c809957bbfae9">00049</a>     <a class="code" href="classcinder_1_1_quaternion.html#a6ba7cef405bde4bc871c809957bbfae9">Quaternion</a>(): <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>( 1 ), <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>( 0, 0, 0 ){} <span class="comment">// default constructor is identity quat</span>
<a name="l00050"></a>00050     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> FromT&gt;
<a name="l00051"></a><a class="code" href="classcinder_1_1_quaternion.html#aa9b690ef649c6429bbff9589cdcf7306">00051</a>     <a class="code" href="classcinder_1_1_quaternion.html#aa9b690ef649c6429bbff9589cdcf7306">Quaternion</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;FromT&gt;</a>&amp; q ) : <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>( static_cast&lt;T&gt;( q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> ) ), <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>( q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> ) {}
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="classcinder_1_1_quaternion.html#a5f798dd4b06ddb48ad218dd2b6756ed3">00053</a>     <a class="code" href="classcinder_1_1_quaternion.html#a5f798dd4b06ddb48ad218dd2b6756ed3">Quaternion</a>( T aW, T x, T y, T z ): <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>( aW ), <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>( x, y, z ) {} 
<a name="l00054"></a>00054     <span class="comment">// construct from axis-angle</span>
<a name="l00055"></a><a class="code" href="classcinder_1_1_quaternion.html#a983f0a2a24d0d6cf4931adf618b63a28">00055</a>     <a class="code" href="classcinder_1_1_quaternion.html#a983f0a2a24d0d6cf4931adf618b63a28">Quaternion</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;axis, T radians ) { <span class="keyword">set</span>( axis, radians ); } 
<a name="l00056"></a><a class="code" href="classcinder_1_1_quaternion.html#ae7fac6ed5fad1811552c1370a6ca2960">00056</a>     <a class="code" href="classcinder_1_1_quaternion.html#ae7fac6ed5fad1811552c1370a6ca2960">Quaternion</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;from, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;to ) { <span class="keyword">set</span>( from, to ); }
<a name="l00057"></a>00057     <span class="comment">// create from euler angles in radians expressed in ZYX rotation order</span>
<a name="l00058"></a><a class="code" href="classcinder_1_1_quaternion.html#a8f1fe7ef7acac40ceeefe76bb551d67d">00058</a>     <a class="code" href="classcinder_1_1_quaternion.html#a8f1fe7ef7acac40ceeefe76bb551d67d">Quaternion</a>( T xRotation, T yRotation, T zRotation ) { <span class="keyword">set</span>( xRotation, yRotation, zRotation ); }
<a name="l00059"></a><a class="code" href="classcinder_1_1_quaternion.html#afef102602b6d49dd835042b9b4ca959c">00059</a>     <a class="code" href="classcinder_1_1_quaternion.html#afef102602b6d49dd835042b9b4ca959c">Quaternion</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_matrix44.html">Matrix44&lt;T&gt;</a> &amp;m ) { <span class="keyword">set</span>( m ); }
<a name="l00060"></a>00060     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Y&gt;
<a name="l00061"></a><a class="code" href="classcinder_1_1_quaternion.html#a1bb5c232f88074f6eff60b01dc55c5bd">00061</a>     <span class="keyword">explicit</span> <a class="code" href="classcinder_1_1_quaternion.html#a6ba7cef405bde4bc871c809957bbfae9">Quaternion</a>( <span class="keyword">const</span> Y &amp;<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> )
<a name="l00062"></a>00062         : <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>( <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html">QUATCONV</a>&lt;<a class="code" href="classcinder_1_1_quaternion.html">Quaternion</a>&lt;typename <a class="code" href="classcinder_1_1_quaternion.html">Quaternion</a>::<a class="code" href="classcinder_1_1_quaternion.html#ad62edd045ae9eb51c029fbdc7bca81b8">TYPE</a>&gt;,Y&gt;::getW( v ) ), v( <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html">QUATCONV</a>&lt;typename <a class="code" href="classcinder_1_1_quaternion.html">Quaternion</a>::<a class="code" href="classcinder_1_1_quaternion.html#ad62edd045ae9eb51c029fbdc7bca81b8">TYPE</a>,Y&gt;::getX( v ), <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html">QUATCONV</a>&lt;typename <a class="code" href="classcinder_1_1_quaternion.html">Quaternion</a>::<a class="code" href="classcinder_1_1_quaternion.html#ad62edd045ae9eb51c029fbdc7bca81b8">TYPE</a>,Y&gt;::getY( v ), <a class="code" href="structcinder_1_1_q_u_a_t_c_o_n_v.html">QUATCONV</a>&lt;typename <a class="code" href="classcinder_1_1_quaternion.html">Quaternion</a>::<a class="code" href="classcinder_1_1_quaternion.html#ad62edd045ae9eb51c029fbdc7bca81b8">TYPE</a>,Y&gt;::getZ( v ) )
<a name="l00063"></a>00063     {}
<a name="l00064"></a>00064     
<a name="l00065"></a>00065     <span class="comment">// get axis-angle representation&#39;s axis</span>
<a name="l00066"></a><a class="code" href="classcinder_1_1_quaternion.html#aa746542aae6f7549f6ccf7210c880c61">00066</a>     <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#aa746542aae6f7549f6ccf7210c880c61">getAxis</a>()<span class="keyword"> const</span>
<a name="l00067"></a>00067 <span class="keyword">    </span>{
<a name="l00068"></a>00068         T cos_angle = <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00069"></a>00069         T invLen = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 ) / <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sqrt</a>( static_cast&lt;T&gt;( 1.0 ) - cos_angle * cos_angle );
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> * invLen;
<a name="l00072"></a>00072     }
<a name="l00073"></a>00073     
<a name="l00074"></a>00074     <span class="comment">// get axis-angle representation&#39;s angle in radians</span>
<a name="l00075"></a><a class="code" href="classcinder_1_1_quaternion.html#ae92a166f5b47ce8897d597008d53ffdc">00075</a>     T <a class="code" href="classcinder_1_1_quaternion.html#ae92a166f5b47ce8897d597008d53ffdc">getAngle</a>()<span class="keyword"> const</span>
<a name="l00076"></a>00076 <span class="keyword">    </span>{
<a name="l00077"></a>00077         T cos_angle = <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00078"></a>00078         <span class="keywordflow">return</span> <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::acos</a>( cos_angle ) * 2;
<a name="l00079"></a>00079     }
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="classcinder_1_1_quaternion.html#ac521ec78976e3b081262e0247a2a8017">00081</a>     T <a class="code" href="classcinder_1_1_quaternion.html#ac521ec78976e3b081262e0247a2a8017">getPitch</a>()<span class="keyword"> const</span>
<a name="l00082"></a>00082 <span class="keyword">    </span>{
<a name="l00083"></a>00083         <span class="keywordflow">return</span> <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::atan2</a>( (T)2 * ( <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z + <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x ), <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> - <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x - <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z );
<a name="l00084"></a>00084     }
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="classcinder_1_1_quaternion.html#a878a0699cfe2f636199528128aac4ced">00086</a>     T <a class="code" href="classcinder_1_1_quaternion.html#a878a0699cfe2f636199528128aac4ced">getYaw</a>()<span class="keyword"> const</span>
<a name="l00087"></a>00087 <span class="keyword">    </span>{
<a name="l00088"></a>00088         <span class="keywordflow">return</span> <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( (T)-2 * ( <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z - <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y ) );
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="classcinder_1_1_quaternion.html#a6e7871ce5bc6e7fc160f49230c673d71">00091</a>     T <a class="code" href="classcinder_1_1_quaternion.html#a6e7871ce5bc6e7fc160f49230c673d71">getRoll</a>()<span class="keyword"> const</span>
<a name="l00092"></a>00092 <span class="keyword">    </span>{
<a name="l00093"></a>00093         <span class="keywordflow">return</span> <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::atan2</a>( (T)2 * ( <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z), <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x - <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y - <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z );
<a name="l00094"></a>00094     }
<a name="l00095"></a>00095     
<a name="l00096"></a><a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">00096</a>     T <a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;quat )<span class="keyword"> const</span>
<a name="l00097"></a>00097 <span class="keyword">    </span>{
<a name="l00098"></a>00098         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * quat.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.dot( quat.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> );
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100     
<a name="l00101"></a><a class="code" href="classcinder_1_1_quaternion.html#a1b2fd851554255df73c11cfeb8afc071">00101</a>     T <a class="code" href="classcinder_1_1_quaternion.html#a1b2fd851554255df73c11cfeb8afc071">length</a>()<span class="keyword"> const</span>
<a name="l00102"></a>00102 <span class="keyword">    </span>{
<a name="l00103"></a>00103         <span class="keywordflow">return</span> (T)std::sqrt( <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.lengthSquared() ); 
<a name="l00104"></a>00104     }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="classcinder_1_1_quaternion.html#aef8f610fdab962be8229d3ab70149846">00106</a>     T <a class="code" href="classcinder_1_1_quaternion.html#aef8f610fdab962be8229d3ab70149846">lengthSquared</a>()<span class="keyword"> const</span>
<a name="l00107"></a>00107 <span class="keyword">    </span>{
<a name="l00108"></a>00108         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.lengthSquared();   
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a><a class="code" href="classcinder_1_1_quaternion.html#ab7329f379f83458653cc0cb67a2c25ba">00111</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#ab7329f379f83458653cc0cb67a2c25ba">inverse</a>()<span class="keyword"> const</span>
<a name="l00112"></a>00112 <span class="keyword">    </span>{
<a name="l00113"></a>00113         T norm = <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z;
<a name="l00114"></a>00114         <span class="comment">// if we&#39;re the zero quaternion, just return identity</span>
<a name="l00115"></a>00115         <span class="comment">/*if( ! ( math&lt;T&gt;::abs( norm ) &lt; EPSILON_VALUE ) ) {</span>
<a name="l00116"></a>00116 <span class="comment">            return identity();</span>
<a name="l00117"></a>00117 <span class="comment">        }*/</span>
<a name="l00118"></a>00118 
<a name="l00119"></a>00119         T normRecip = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0f ) / norm;
<a name="l00120"></a>00120         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>( normRecip * <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>, -normRecip * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x, -normRecip * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y, -normRecip * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z );
<a name="l00121"></a>00121     }
<a name="l00122"></a>00122 
<a name="l00123"></a><a class="code" href="classcinder_1_1_quaternion.html#a02666bba8e1a569e8e0603255edad68c">00123</a>     <span class="keywordtype">void</span> <a class="code" href="classcinder_1_1_quaternion.html#a02666bba8e1a569e8e0603255edad68c">normalize</a>()
<a name="l00124"></a>00124     {
<a name="l00125"></a>00125         <span class="keywordflow">if</span>( T len = <a class="code" href="classcinder_1_1_quaternion.html#a1b2fd851554255df73c11cfeb8afc071">length</a>() ) {
<a name="l00126"></a>00126             <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> /= len;
<a name="l00127"></a>00127             <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> /= len;
<a name="l00128"></a>00128         }
<a name="l00129"></a>00129         <span class="keywordflow">else</span> {
<a name="l00130"></a>00130             <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 );
<a name="l00131"></a>00131             <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>( 0, 0, 0 );
<a name="l00132"></a>00132         }
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="classcinder_1_1_quaternion.html#ae8321a260b782e5605e153667c523d45">00135</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#ae8321a260b782e5605e153667c523d45">normalized</a>()<span class="keyword"> const</span>
<a name="l00136"></a>00136 <span class="keyword">    </span>{
<a name="l00137"></a>00137         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> result = *<span class="keyword">this</span>;
<a name="l00138"></a>00138     
<a name="l00139"></a>00139         <span class="keywordflow">if</span>( T len = <a class="code" href="classcinder_1_1_quaternion.html#a1b2fd851554255df73c11cfeb8afc071">length</a>() ) {
<a name="l00140"></a>00140             result.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> /= len;
<a name="l00141"></a>00141             result.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> /= len;
<a name="l00142"></a>00142         }
<a name="l00143"></a>00143         <span class="keywordflow">else</span> {
<a name="l00144"></a>00144             result.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 );
<a name="l00145"></a>00145             result.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>( 0, 0, 0 );
<a name="l00146"></a>00146         }
<a name="l00147"></a>00147         
<a name="l00148"></a>00148         <span class="keywordflow">return</span> result;
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     <span class="comment">// For unit quaternion, from Advanced Animation and </span>
<a name="l00152"></a>00152     <span class="comment">// Rendering Techniques by Watt and Watt, Page 366:</span>
<a name="l00153"></a><a class="code" href="classcinder_1_1_quaternion.html#ac9d43961371a5c3be27482c1fd090908">00153</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#ac9d43961371a5c3be27482c1fd090908">log</a>()<span class="keyword"> const</span>
<a name="l00154"></a>00154 <span class="keyword">    </span>{
<a name="l00155"></a>00155         T theta = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::acos</a>( std::min( <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>, (T) 1.0 ) );
<a name="l00156"></a>00156 
<a name="l00157"></a>00157         <span class="keywordflow">if</span>( theta == 0 )
<a name="l00158"></a>00158             <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>( <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>, 0 );
<a name="l00159"></a>00159         
<a name="l00160"></a>00160         T sintheta = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( theta );
<a name="l00161"></a>00161         
<a name="l00162"></a>00162         T k;
<a name="l00163"></a>00163         <span class="keywordflow">if</span> ( abs( sintheta ) &lt; 1 &amp;&amp; abs( theta ) &gt;= 3.402823466e+38F * abs( sintheta ) )
<a name="l00164"></a>00164             k = 1;
<a name="l00165"></a>00165         <span class="keywordflow">else</span>
<a name="l00166"></a>00166             k = theta / sintheta;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>( (T)0, v.x * k, v.y * k, v.z * k );
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171     <span class="comment">// For pure quaternion (zero scalar part):</span>
<a name="l00172"></a>00172     <span class="comment">// from Advanced Animation and Rendering</span>
<a name="l00173"></a>00173     <span class="comment">// Techniques by Watt and Watt, Page 366:</span>
<a name="l00174"></a><a class="code" href="classcinder_1_1_quaternion.html#a9dd8b284d61115ab48316c0bc91e6020">00174</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a9dd8b284d61115ab48316c0bc91e6020">exp</a>()<span class="keyword"> const</span>
<a name="l00175"></a>00175 <span class="keyword">    </span>{
<a name="l00176"></a>00176         T theta = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.length();
<a name="l00177"></a>00177         T sintheta = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( theta );
<a name="l00178"></a>00178         
<a name="l00179"></a>00179         T k;
<a name="l00180"></a>00180         <span class="keywordflow">if</span>( abs( theta ) &lt; 1 &amp;&amp; abs( sintheta ) &gt;= 3.402823466e+38F * abs( theta ) )
<a name="l00181"></a>00181             k = 1;
<a name="l00182"></a>00182         <span class="keywordflow">else</span>
<a name="l00183"></a>00183             k = sintheta / theta;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185         T costheta = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::cos</a>( theta );
<a name="l00186"></a>00186 
<a name="l00187"></a>00187         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>( costheta, <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * k, <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * k, <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * k );
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189 
<a name="l00190"></a><a class="code" href="classcinder_1_1_quaternion.html#ab6b4fe4262fea74f528a08c47fdb5b49">00190</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#ab6b4fe4262fea74f528a08c47fdb5b49">inverted</a>()<span class="keyword"> const</span>
<a name="l00191"></a>00191 <span class="keyword">    </span>{
<a name="l00192"></a>00192         T qdot = this-&gt;<a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( *<span class="keyword">this</span> );
<a name="l00193"></a>00193         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html#a6ba7cef405bde4bc871c809957bbfae9">Quaternion</a>( -<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> / qdot, <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> / qdot );
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="classcinder_1_1_quaternion.html#a7e43238bc22fe3c703768a0f4bb1bedf">00196</a>     <span class="keywordtype">void</span> <a class="code" href="classcinder_1_1_quaternion.html#a7e43238bc22fe3c703768a0f4bb1bedf">invert</a>()
<a name="l00197"></a>00197     {
<a name="l00198"></a>00198         T qdot = this-&gt;<a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( *<span class="keyword">this</span> );
<a name="l00199"></a>00199         <span class="keyword">set</span>( -<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> / qdot, <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> / qdot );     
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201 
<a name="l00202"></a><a class="code" href="classcinder_1_1_quaternion.html#ab5abd69352eb87abe92f712ae193bea1">00202</a>     <span class="keywordtype">void</span> <span class="keyword">set</span>( T aW, T x, T y, T z )
<a name="l00203"></a>00203     {
<a name="l00204"></a>00204         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = aW;
<a name="l00205"></a>00205         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>( x, y, z );
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="preprocessor">#if 1</span>
<a name="l00209"></a><a class="code" href="classcinder_1_1_quaternion.html#a8f21c3c2e2e3db481699f960148035b7">00209</a> <span class="preprocessor"></span>    <span class="keywordtype">void</span> <span class="keyword">set</span>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;from, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;to )
<a name="l00210"></a>00210     {
<a name="l00211"></a>00211         <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> axis = from.cross( to );
<a name="l00212"></a>00212         
<a name="l00213"></a>00213         <span class="keyword">set</span>( from.dot( to ), axis.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a>, axis.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a>, axis.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> );
<a name="l00214"></a>00214         <a class="code" href="classcinder_1_1_quaternion.html#a02666bba8e1a569e8e0603255edad68c">normalize</a>();
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> += <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 );
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         <span class="keywordflow">if</span>( <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> &lt;= EPSILON ) {
<a name="l00219"></a>00219             <span class="keywordflow">if</span> ( from.z * from.z &gt; from.x * from.x ) {
<a name="l00220"></a>00220                 <span class="keyword">set</span>( <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 0.0 ), static_cast&lt;T&gt;( 0.0 ), from.z, -from.y );
<a name="l00221"></a>00221             }
<a name="l00222"></a>00222             <span class="keywordflow">else</span> {
<a name="l00223"></a>00223                 <span class="keyword">set</span>( <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 0.0 ), from.y, -from.x, static_cast&lt;T&gt;( 0.0 ) );
<a name="l00224"></a>00224             }
<a name="l00225"></a>00225         }
<a name="l00226"></a>00226         
<a name="l00227"></a>00227         <a class="code" href="classcinder_1_1_quaternion.html#a02666bba8e1a569e8e0603255edad68c">normalize</a>();
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229 <span class="preprocessor">#else</span>
<a name="l00230"></a><a class="code" href="classcinder_1_1_quaternion.html#a8f21c3c2e2e3db481699f960148035b7">00230</a> <span class="preprocessor"></span>    <span class="keywordtype">void</span> <span class="keyword">set</span>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;from, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;to )
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232         <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> f0 = from.normalized();
<a name="l00233"></a>00233         <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> t0 = to.normalized();
<a name="l00234"></a>00234 
<a name="l00235"></a>00235         <span class="keywordflow">if</span>( f0.<a class="code" href="classcinder_1_1_vec3.html#a02d6ef9285886199550e77fc17b0a03f">dot</a>( t0 ) &gt;= 0 ) { <span class="comment">// The rotation angle is less than or equal to pi/2.</span>
<a name="l00236"></a>00236             <a class="code" href="classcinder_1_1_quaternion.html#ab603107998df10d5749d2536648717af">setRotationInternal</a> (f0, t0, *<span class="keyword">this</span>);
<a name="l00237"></a>00237         }
<a name="l00238"></a>00238         <span class="keywordflow">else</span> {
<a name="l00239"></a>00239             <span class="comment">// The angle is greater than pi/2.  After computing h0,</span>
<a name="l00240"></a>00240             <span class="comment">// which is halfway between f0 and t0, we rotate first</span>
<a name="l00241"></a>00241             <span class="comment">// from f0 to h0, then from h0 to t0.</span>
<a name="l00242"></a>00242 
<a name="l00243"></a>00243             <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> h0 = (f0 + t0).<a class="code" href="classcinder_1_1_quaternion.html#ae8321a260b782e5605e153667c523d45">normalized</a>();
<a name="l00244"></a>00244 
<a name="l00245"></a>00245             <span class="keywordflow">if</span>( h0.<a class="code" href="classcinder_1_1_vec3.html#a02d6ef9285886199550e77fc17b0a03f">dot</a>( h0 ) != 0 ) {
<a name="l00246"></a>00246                 <a class="code" href="classcinder_1_1_quaternion.html#ab603107998df10d5749d2536648717af">setRotationInternal</a>( f0, h0, *<span class="keyword">this</span> );
<a name="l00247"></a>00247                 <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> q;
<a name="l00248"></a>00248                 <a class="code" href="classcinder_1_1_quaternion.html#ab603107998df10d5749d2536648717af">setRotationInternal</a>( h0, t0, q );
<a name="l00249"></a>00249                 
<a name="l00250"></a>00250                 <span class="keyword">set</span>( q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z,
<a name="l00251"></a>00251                     q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x + q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y,
<a name="l00252"></a>00252                     q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z,
<a name="l00253"></a>00253                     q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z + q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x );
<a name="l00254"></a>00254                 
<a name="l00255"></a>00255                 <span class="comment">//*this *= q;</span>
<a name="l00256"></a>00256             }
<a name="l00257"></a>00257             <span class="keywordflow">else</span> {
<a name="l00258"></a>00258                 <span class="comment">// f0 and t0 point in exactly opposite directions.</span>
<a name="l00259"></a>00259                 <span class="comment">// Pick an arbitrary axis that is orthogonal to f0,</span>
<a name="l00260"></a>00260                 <span class="comment">// and rotate by pi.</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262                 <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = T( 0 );
<a name="l00263"></a>00263 
<a name="l00264"></a>00264                 <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> f02 = f0 * f0;
<a name="l00265"></a>00265 
<a name="l00266"></a>00266                 <span class="keywordflow">if</span>( ( f02.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> &lt;= f02.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> ) &amp;&amp; ( f02.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> &lt;= f02.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> ) )
<a name="l00267"></a>00267                     <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = f0.cross( <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>( 1, 0, 0 ) ).normalized();
<a name="l00268"></a>00268                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( f02.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> &lt;= f02.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> )
<a name="l00269"></a>00269                     <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = f0.cross( <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>( 0, 1, 0 ) ).normalized();
<a name="l00270"></a>00270                 <span class="keywordflow">else</span>
<a name="l00271"></a>00271                     <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = f0.cross( <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>( 0, 0, 1 ) ).normalized();
<a name="l00272"></a>00272             }
<a name="l00273"></a>00273         }
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275 
<a name="l00276"></a><a class="code" href="classcinder_1_1_quaternion.html#ab603107998df10d5749d2536648717af">00276</a>     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classcinder_1_1_quaternion.html#ab603107998df10d5749d2536648717af">setRotationInternal</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;f0, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;t0, <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q )
<a name="l00277"></a>00277     {
<a name="l00278"></a>00278         <span class="comment">//</span>
<a name="l00279"></a>00279         <span class="comment">// The following is equivalent to setAxisAngle(n,2*phi),</span>
<a name="l00280"></a>00280         <span class="comment">// where the rotation axis, is orthogonal to the f0 and</span>
<a name="l00281"></a>00281         <span class="comment">// t0 vectors, and 2*phi is the angle between f0 and t0.</span>
<a name="l00282"></a>00282         <span class="comment">//</span>
<a name="l00283"></a>00283         <span class="comment">// This function is called by setRotation(), above; it assumes</span>
<a name="l00284"></a>00284         <span class="comment">// that f0 and t0 are normalized and that the angle between</span>
<a name="l00285"></a>00285         <span class="comment">// them is not much greater than pi/2.  This function becomes</span>
<a name="l00286"></a>00286         <span class="comment">// numerically inaccurate if f0 and t0 point into nearly</span>
<a name="l00287"></a>00287         <span class="comment">// opposite directions.</span>
<a name="l00288"></a>00288         <span class="comment">//</span>
<a name="l00289"></a>00289 
<a name="l00290"></a>00290         <span class="comment">// Find a normalized vector, h0, that is half way between f0 and t0.</span>
<a name="l00291"></a>00291         <span class="comment">// The angle between f0 and h0 is phi.</span>
<a name="l00292"></a>00292         <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> h0 = ( f0 + t0 ).<a class="code" href="classcinder_1_1_quaternion.html#ae8321a260b782e5605e153667c523d45">normalized</a>();
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         <span class="comment">// Store the rotation axis and rotation angle.</span>
<a name="l00295"></a>00295         q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = f0.<a class="code" href="classcinder_1_1_vec3.html#a02d6ef9285886199550e77fc17b0a03f">dot</a>( h0 ); <span class="comment">//  f0 ^ h0 == cos (phi)</span>
<a name="l00296"></a>00296         q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = f0.<a class="code" href="classcinder_1_1_vec3.html#a59070f3f9a3f19f945f48df7e9c63661">cross</a>( h0 );   <span class="comment">// (f0 % h0).length() == sin (phi)</span>
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298 <span class="preprocessor">#endif</span>
<a name="l00299"></a>00299 <span class="preprocessor"></span>
<a name="l00300"></a><a class="code" href="classcinder_1_1_quaternion.html#a152636adbd78d6acebe42c3bc3752d44">00300</a>     <span class="keywordtype">void</span> <span class="keyword">set</span>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;axis, T radians )
<a name="l00301"></a>00301     {
<a name="l00302"></a>00302         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::cos</a>( radians / 2 );
<a name="l00303"></a>00303         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = axis.normalized() * <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( radians / 2 );
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306     <span class="comment">// assumes ZYX rotation order and radians</span>
<a name="l00307"></a><a class="code" href="classcinder_1_1_quaternion.html#af72fa42138fcf2a49ab9d3ddb7d531f3">00307</a>     <span class="keywordtype">void</span> <span class="keyword">set</span>( T xRotation, T yRotation, T zRotation )
<a name="l00308"></a>00308     {
<a name="l00309"></a>00309         zRotation *= T( 0.5 );
<a name="l00310"></a>00310         yRotation *= T( 0.5 );
<a name="l00311"></a>00311         xRotation *= T( 0.5 );
<a name="l00312"></a>00312 
<a name="l00313"></a>00313         <span class="comment">// get sines and cosines of half angles</span>
<a name="l00314"></a>00314         T Cx = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::cos</a>( xRotation );
<a name="l00315"></a>00315         T Sx = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( xRotation );
<a name="l00316"></a>00316 
<a name="l00317"></a>00317         T Cy = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::cos</a>( yRotation );
<a name="l00318"></a>00318         T Sy = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( yRotation );
<a name="l00319"></a>00319 
<a name="l00320"></a>00320         T Cz = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::cos</a>( zRotation );
<a name="l00321"></a>00321         T Sz = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( zRotation );
<a name="l00322"></a>00322 
<a name="l00323"></a>00323         <span class="comment">// multiply it out</span>
<a name="l00324"></a>00324         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = Cx*Cy*Cz - Sx*Sy*Sz;
<a name="l00325"></a>00325         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x = Sx*Cy*Cz + Cx*Sy*Sz;
<a name="l00326"></a>00326         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y = Cx*Sy*Cz - Sx*Cy*Sz;
<a name="l00327"></a>00327         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z = Cx*Cy*Sz + Sx*Sy*Cx;
<a name="l00328"></a>00328     }
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="classcinder_1_1_quaternion.html#afc2b183fae25282ab4ecd94329f330e4">00330</a>     <span class="keywordtype">void</span> <a class="code" href="classcinder_1_1_quaternion.html#afc2b183fae25282ab4ecd94329f330e4">getAxisAngle</a>( <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> *axis, T *radians )<span class="keyword"> const</span>
<a name="l00331"></a>00331 <span class="keyword">    </span>{
<a name="l00332"></a>00332         T cos_angle = <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00333"></a>00333         *radians = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::acos</a>( cos_angle ) * 2;
<a name="l00334"></a>00334         T invLen = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 ) / <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sqrt</a>( static_cast&lt;T&gt;( 1.0 ) - cos_angle * cos_angle );
<a name="l00335"></a>00335 
<a name="l00336"></a>00336         axis-&gt;<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * invLen;
<a name="l00337"></a>00337         axis-&gt;<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * invLen;
<a name="l00338"></a>00338         axis-&gt;<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * invLen;
<a name="l00339"></a>00339     }
<a name="l00340"></a>00340 
<a name="l00341"></a><a class="code" href="classcinder_1_1_quaternion.html#a75d4d691080020373ec292a083c519e4">00341</a>     <a class="code" href="classcinder_1_1_matrix44.html">Matrix44&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a75d4d691080020373ec292a083c519e4">toMatrix44</a>()<span class="keyword"> const</span>
<a name="l00342"></a>00342 <span class="keyword">    </span>{
<a name="l00343"></a>00343         <a class="code" href="classcinder_1_1_matrix44.html">Matrix44&lt;T&gt;</a> mV;
<a name="l00344"></a>00344         T xs, ys, zs, wx, wy, wz, xx, xy, xz, yy, yz, zz;
<a name="l00345"></a>00345 
<a name="l00346"></a>00346         xs = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x;   
<a name="l00347"></a>00347         ys = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y;
<a name="l00348"></a>00348         zs = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z;
<a name="l00349"></a>00349         wx = <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * xs;
<a name="l00350"></a>00350         wy = <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * ys;
<a name="l00351"></a>00351         wz = <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * zs;
<a name="l00352"></a>00352         xx = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * xs;
<a name="l00353"></a>00353         xy = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * ys;
<a name="l00354"></a>00354         xz = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * zs;
<a name="l00355"></a>00355         yy = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * ys;
<a name="l00356"></a>00356         yz = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * zs;
<a name="l00357"></a>00357         zz = <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * zs;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359         mV[0] = T( 1 ) - ( yy + zz );
<a name="l00360"></a>00360         mV[4] = xy - wz;
<a name="l00361"></a>00361         mV[8] = xz + wy;
<a name="l00362"></a>00362         mV[12] = 0;
<a name="l00363"></a>00363         
<a name="l00364"></a>00364         mV[1] = xy + wz;
<a name="l00365"></a>00365         mV[5] = T( 1 ) - ( xx + zz );
<a name="l00366"></a>00366         mV[9] = yz - wx;
<a name="l00367"></a>00367         mV[13] = 0;
<a name="l00368"></a>00368         
<a name="l00369"></a>00369         mV[2] = xz - wy;
<a name="l00370"></a>00370         mV[6] = yz + wx;
<a name="l00371"></a>00371         mV[10] = T( 1 ) - ( xx + yy );
<a name="l00372"></a>00372         mV[14] = 0;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         mV[3] = 0;
<a name="l00375"></a>00375         mV[7] = 0;
<a name="l00376"></a>00376         mV[11] = 0;
<a name="l00377"></a>00377         mV[15] = T( 1 );
<a name="l00378"></a>00378         
<a name="l00379"></a>00379         <span class="keywordflow">return</span> mV;
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381 
<a name="l00382"></a><a class="code" href="classcinder_1_1_quaternion.html#ab452e50627f7f5d09ad4c5aa1b283098">00382</a>     <a class="code" href="classcinder_1_1_quaternion.html#ab452e50627f7f5d09ad4c5aa1b283098">operator Matrix44&lt;T&gt;</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html#a75d4d691080020373ec292a083c519e4">toMatrix44</a>(); }
<a name="l00383"></a>00383 
<a name="l00384"></a><a class="code" href="classcinder_1_1_quaternion.html#aa26bd5f757eb4ec09e68600a423076f2">00384</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#aa26bd5f757eb4ec09e68600a423076f2">lerp</a>( T t, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;end )<span class="keyword"> const</span>
<a name="l00385"></a>00385 <span class="keyword">    </span>{
<a name="l00386"></a>00386         <span class="comment">// get cos of &quot;angle&quot; between quaternions</span>
<a name="l00387"></a>00387         <span class="keywordtype">float</span> cosTheta = <a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( end );
<a name="l00388"></a>00388 
<a name="l00389"></a>00389         <span class="comment">// initialize result</span>
<a name="l00390"></a>00390         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> result = t * end;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392         <span class="comment">// if &quot;angle&quot; between quaternions is less than 90 degrees</span>
<a name="l00393"></a>00393         <span class="keywordflow">if</span>( cosTheta &gt;= EPSILON ) {
<a name="l00394"></a>00394             <span class="comment">// use standard interpolation</span>
<a name="l00395"></a>00395             result += *<span class="keyword">this</span> * ( <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 ) - t );
<a name="l00396"></a>00396         }
<a name="l00397"></a>00397         <span class="keywordflow">else</span> {
<a name="l00398"></a>00398             <span class="comment">// otherwise, take the shorter path</span>
<a name="l00399"></a>00399             result += *<span class="keyword">this</span> * ( t - <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 ) );
<a name="l00400"></a>00400         }
<a name="l00401"></a>00401         
<a name="l00402"></a>00402         <span class="keywordflow">return</span> result;
<a name="l00403"></a>00403     }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405     <span class="comment">// This method does *not* interpolate along the shortest</span>
<a name="l00406"></a>00406     <span class="comment">// arc between q1 and q2.  If you desire interpolation</span>
<a name="l00407"></a>00407     <span class="comment">// along the shortest arc, and q1.dot( q2 ) is negative, then</span>
<a name="l00408"></a>00408     <span class="comment">// consider flipping the second quaternion explicitly.</span>
<a name="l00409"></a>00409     <span class="comment">//</span>
<a name="l00410"></a>00410     <span class="comment">// NOTE: the difference between this and slerp isn&#39;t clear, but we&#39;re using</span>
<a name="l00411"></a>00411     <span class="comment">// the Don Hatch / ilmbase squad code which explicity requires this impl. of slerp</span>
<a name="l00412"></a>00412     <span class="comment">// so I&#39;m leaving it for now</span>
<a name="l00413"></a><a class="code" href="classcinder_1_1_quaternion.html#a319bc4a42cde521f3b13e6af88bf6481">00413</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a319bc4a42cde521f3b13e6af88bf6481">slerpShortestUnenforced</a>( T t, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;end )<span class="keyword"> const</span>
<a name="l00414"></a>00414 <span class="keyword">    </span>{
<a name="l00415"></a>00415         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> d = *<span class="keyword">this</span> - end;
<a name="l00416"></a>00416         T lengthD = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sqrt</a>( this-&gt;<a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( end ) );
<a name="l00417"></a>00417 
<a name="l00418"></a>00418         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> st = *<span class="keyword">this</span> + end;
<a name="l00419"></a>00419         T lengthS = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sqrt</a>( st.<a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( st ) );
<a name="l00420"></a>00420     
<a name="l00421"></a>00421         T a = 2 * <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::atan2</a>( lengthD, lengthS );;
<a name="l00422"></a>00422         T s = 1 - t;
<a name="l00423"></a>00423 
<a name="l00424"></a>00424         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> q( *<span class="keyword">this</span> * ( <a class="code" href="namespacecinder.html#ae1f37793c1f2d7ae38c75452b47a33d6">sinx_over_x</a>( s * a ) / <a class="code" href="namespacecinder.html#ae1f37793c1f2d7ae38c75452b47a33d6">sinx_over_x</a>( a ) * s ) +
<a name="l00425"></a>00425                 end * ( <a class="code" href="namespacecinder.html#ae1f37793c1f2d7ae38c75452b47a33d6">sinx_over_x</a>( t * a ) / <a class="code" href="namespacecinder.html#ae1f37793c1f2d7ae38c75452b47a33d6">sinx_over_x</a>( a ) * t ) );
<a name="l00426"></a>00426 
<a name="l00427"></a>00427         <span class="keywordflow">return</span> q.<a class="code" href="classcinder_1_1_quaternion.html#ae8321a260b782e5605e153667c523d45">normalized</a>();
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429 
<a name="l00430"></a><a class="code" href="classcinder_1_1_quaternion.html#a62a81f89ab09fc3f6a2dbbecd3ac3f34">00430</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a62a81f89ab09fc3f6a2dbbecd3ac3f34">slerp</a>( T t, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;end )<span class="keyword"> const</span>
<a name="l00431"></a>00431 <span class="keyword">    </span>{
<a name="l00432"></a>00432         <span class="comment">// get cosine of &quot;angle&quot; between quaternions</span>
<a name="l00433"></a>00433         T cosTheta = this-&gt;<a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( end );
<a name="l00434"></a>00434         T startInterp, endInterp;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436         <span class="comment">// if &quot;angle&quot; between quaternions is less than 90 degrees</span>
<a name="l00437"></a>00437         <span class="keywordflow">if</span>( cosTheta &gt;= EPSILON ) {
<a name="l00438"></a>00438             <span class="comment">// if angle is greater than zero</span>
<a name="l00439"></a>00439             <span class="keywordflow">if</span>( ( static_cast&lt;T&gt;( 1.0 ) - cosTheta ) &gt; EPSILON ) {
<a name="l00440"></a>00440                 <span class="comment">// use standard slerp</span>
<a name="l00441"></a>00441                 T theta = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::acos</a>( cosTheta );
<a name="l00442"></a>00442                 T recipSinTheta = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 ) / <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( theta );
<a name="l00443"></a>00443 
<a name="l00444"></a>00444                 startInterp = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( ( static_cast&lt;T&gt;( 1.0 ) - t ) * theta ) * recipSinTheta;
<a name="l00445"></a>00445                 endInterp = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( t * theta ) * recipSinTheta;
<a name="l00446"></a>00446             }
<a name="l00447"></a>00447             <span class="comment">// angle is close to zero</span>
<a name="l00448"></a>00448             <span class="keywordflow">else</span> {
<a name="l00449"></a>00449                 <span class="comment">// use linear interpolation</span>
<a name="l00450"></a>00450                 startInterp = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 ) - t;
<a name="l00451"></a>00451                 endInterp = t;
<a name="l00452"></a>00452             }
<a name="l00453"></a>00453         }
<a name="l00454"></a>00454         <span class="comment">// otherwise, take the shorter route</span>
<a name="l00455"></a>00455         <span class="keywordflow">else</span> {
<a name="l00456"></a>00456             <span class="comment">// if angle is less than 180 degrees</span>
<a name="l00457"></a>00457             <span class="keywordflow">if</span>( ( static_cast&lt;T&gt;( 1.0 ) + cosTheta ) &gt; EPSILON ) {
<a name="l00458"></a>00458                 <span class="comment">// use slerp w/negation of start quaternion</span>
<a name="l00459"></a>00459                 T theta = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::acos</a>( -cosTheta );
<a name="l00460"></a>00460                 T recipSinTheta = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 ) / <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( theta );
<a name="l00461"></a>00461 
<a name="l00462"></a>00462                 startInterp = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( ( t - static_cast&lt;T&gt;( 1.0 ) ) * theta ) * recipSinTheta;
<a name="l00463"></a>00463                 endInterp = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sin</a>( t * theta ) * recipSinTheta;
<a name="l00464"></a>00464             }
<a name="l00465"></a>00465             <span class="comment">// angle is close to 180 degrees</span>
<a name="l00466"></a>00466             <span class="keywordflow">else</span> {
<a name="l00467"></a>00467                 <span class="comment">// use lerp w/negation of start quaternion</span>
<a name="l00468"></a>00468                 startInterp = t - <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( 1.0 );
<a name="l00469"></a>00469                 endInterp = t;
<a name="l00470"></a>00470             }
<a name="l00471"></a>00471         }
<a name="l00472"></a>00472         
<a name="l00473"></a>00473         <span class="keywordflow">return</span> *<span class="keyword">this</span> * startInterp + end * endInterp;
<a name="l00474"></a>00474     }
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     <span class="comment">// Spherical Quadrangle Interpolation -</span>
<a name="l00477"></a>00477     <span class="comment">// from Advanced Animation and Rendering</span>
<a name="l00478"></a>00478     <span class="comment">// Techniques by Watt and Watt, Page 366:</span>
<a name="l00479"></a>00479     <span class="comment">// It constructs a spherical cubic interpolation as </span>
<a name="l00480"></a>00480     <span class="comment">// a series of three spherical linear interpolations </span>
<a name="l00481"></a>00481     <span class="comment">// of a quadrangle of unit quaternions. </span>
<a name="l00482"></a><a class="code" href="classcinder_1_1_quaternion.html#ad50bdcf0a52c19587f96e77bee37b577">00482</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#ad50bdcf0a52c19587f96e77bee37b577">squadShortestEnforced</a>( T t, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;qa, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;qb, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q2 )<span class="keyword"> const</span>
<a name="l00483"></a>00483 <span class="keyword">    </span>{
<a name="l00484"></a>00484         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> r1;
<a name="l00485"></a>00485         <span class="keywordflow">if</span>( this-&gt;<a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( q2 ) &gt;= 0 )
<a name="l00486"></a>00486             r1 = this-&gt;<a class="code" href="classcinder_1_1_quaternion.html#a319bc4a42cde521f3b13e6af88bf6481">slerpShortestUnenforced</a>( t, q2 );
<a name="l00487"></a>00487         <span class="keywordflow">else</span>
<a name="l00488"></a>00488             r1 = this-&gt;<a class="code" href="classcinder_1_1_quaternion.html#a319bc4a42cde521f3b13e6af88bf6481">slerpShortestUnenforced</a>( t, q2.<a class="code" href="classcinder_1_1_quaternion.html#ab6b4fe4262fea74f528a08c47fdb5b49">inverted</a>() );
<a name="l00489"></a>00489         
<a name="l00490"></a>00490         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> r2;
<a name="l00491"></a>00491         <span class="keywordflow">if</span>( qa.<a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( qb ) &gt;= 0 )
<a name="l00492"></a>00492             r2 = qa.<a class="code" href="classcinder_1_1_quaternion.html#a319bc4a42cde521f3b13e6af88bf6481">slerpShortestUnenforced</a>( t, qb );
<a name="l00493"></a>00493         <span class="keywordflow">else</span>
<a name="l00494"></a>00494             r2 = qa.<a class="code" href="classcinder_1_1_quaternion.html#a319bc4a42cde521f3b13e6af88bf6481">slerpShortestUnenforced</a>( t, qb.<a class="code" href="classcinder_1_1_quaternion.html#ab6b4fe4262fea74f528a08c47fdb5b49">inverted</a>() );
<a name="l00495"></a>00495         
<a name="l00496"></a>00496         <span class="keywordflow">if</span>( r1.<a class="code" href="classcinder_1_1_quaternion.html#ad9aa89029382490f162f23c4e4875fab">dot</a>( r2 ) &gt;= 0 )
<a name="l00497"></a>00497             <span class="keywordflow">return</span> r1.<a class="code" href="classcinder_1_1_quaternion.html#a319bc4a42cde521f3b13e6af88bf6481">slerpShortestUnenforced</a>( 2 * t * (1-t), r2 );
<a name="l00498"></a>00498         <span class="keywordflow">else</span>
<a name="l00499"></a>00499             <span class="keywordflow">return</span> r1.<a class="code" href="classcinder_1_1_quaternion.html#a319bc4a42cde521f3b13e6af88bf6481">slerpShortestUnenforced</a>( 2 * t * (1-t), r2.inverted() );
<a name="l00500"></a>00500     }
<a name="l00501"></a>00501 
<a name="l00502"></a><a class="code" href="classcinder_1_1_quaternion.html#a10a7ff04a099de6bf54a6a52761b9ddb">00502</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a10a7ff04a099de6bf54a6a52761b9ddb">squad</a>( T t, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;qa, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;qb, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q2 )<span class="keyword"> const</span>
<a name="l00503"></a>00503 <span class="keyword">    </span>{
<a name="l00504"></a>00504         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> r1 = this-&gt;<a class="code" href="classcinder_1_1_quaternion.html#a62a81f89ab09fc3f6a2dbbecd3ac3f34">slerp</a>( t, q2 );    
<a name="l00505"></a>00505         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> r2 = qa.<a class="code" href="classcinder_1_1_quaternion.html#a62a81f89ab09fc3f6a2dbbecd3ac3f34">slerp</a>( t, qb );
<a name="l00506"></a>00506         <span class="keywordflow">return</span> r1.<a class="code" href="classcinder_1_1_quaternion.html#a62a81f89ab09fc3f6a2dbbecd3ac3f34">slerp</a>( 2 * t * (1-t), r2 );
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="comment">// Spherical Cubic Spline Interpolation -</span>
<a name="l00510"></a>00510     <span class="comment">// from Advanced Animation and Rendering</span>
<a name="l00511"></a>00511     <span class="comment">// Techniques by Watt and Watt, Page 366:</span>
<a name="l00512"></a>00512     <span class="comment">// A spherical curve is constructed using three</span>
<a name="l00513"></a>00513     <span class="comment">// spherical linear interpolations of a quadrangle</span>
<a name="l00514"></a>00514     <span class="comment">// of unit quaternions: q1, qa, qb, q2.</span>
<a name="l00515"></a>00515     <span class="comment">// Given a set of quaternion keys: q0, q1, q2, q3,</span>
<a name="l00516"></a>00516     <span class="comment">// this routine does the interpolation between</span>
<a name="l00517"></a>00517     <span class="comment">// q1 and q2 by constructing two intermediate</span>
<a name="l00518"></a>00518     <span class="comment">// quaternions: qa and qb. The qa and qb are </span>
<a name="l00519"></a>00519     <span class="comment">// computed by the intermediate function to </span>
<a name="l00520"></a>00520     <span class="comment">// guarantee the continuity of tangents across</span>
<a name="l00521"></a>00521     <span class="comment">// adjacent cubic segments. The qa represents in-tangent</span>
<a name="l00522"></a>00522     <span class="comment">// for q1 and the qb represents the out-tangent for q2.</span>
<a name="l00523"></a>00523     <span class="comment">// </span>
<a name="l00524"></a>00524     <span class="comment">// The q1 q2 is the cubic segment being interpolated. </span>
<a name="l00525"></a>00525     <span class="comment">// The q0 is from the previous adjacent segment and q3 is </span>
<a name="l00526"></a>00526     <span class="comment">// from the next adjacent segment. The q0 and q3 are used</span>
<a name="l00527"></a>00527     <span class="comment">// in computing qa and qb.</span>
<a name="l00528"></a><a class="code" href="classcinder_1_1_quaternion.html#a07a100ebe5818f80452612fe5ec0692e">00528</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a07a100ebe5818f80452612fe5ec0692e">spline</a>( T t, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q1,
<a name="l00529"></a>00529                <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q2, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q3 )<span class="keyword"> const</span>
<a name="l00530"></a>00530 <span class="keyword">    </span>{
<a name="l00531"></a>00531         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> qa = splineIntermediate( *<span class="keyword">this</span>, q1, q2 );
<a name="l00532"></a>00532         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> qb = splineIntermediate( q1, q2, q3 );
<a name="l00533"></a>00533         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> result = q1.<a class="code" href="classcinder_1_1_quaternion.html#ad50bdcf0a52c19587f96e77bee37b577">squadShortestEnforced</a>( t, qa, qb, q2 );
<a name="l00534"></a>00534 
<a name="l00535"></a>00535         <span class="keywordflow">return</span> result;
<a name="l00536"></a>00536     }
<a name="l00537"></a>00537 
<a name="l00538"></a><a class="code" href="classcinder_1_1_quaternion.html#a278ecd957230f72f122b5f957bb11a0a">00538</a>     <span class="keywordtype">void</span> <span class="keyword">set</span>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_matrix44.html">Matrix44&lt;T&gt;</a> &amp;m )
<a name="l00539"></a>00539     {
<a name="l00540"></a>00540         T trace =  m.m[0] + m.m[5] + m.m[10];
<a name="l00541"></a>00541         <span class="keywordflow">if</span> ( trace &gt; (T)0.0 )
<a name="l00542"></a>00542         {
<a name="l00543"></a>00543             T s = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sqrt</a>( trace + (T)1.0 );
<a name="l00544"></a>00544             <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = s * (T)0.5;
<a name="l00545"></a>00545             T recip = (T)0.5 / s;
<a name="l00546"></a>00546             <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x = ( m.at(2,1) - m.at(1,2) ) * recip;
<a name="l00547"></a>00547             <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y = ( m.at(0,2) - m.at(2,0) ) * recip;
<a name="l00548"></a>00548             <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z = ( m.at(1,0) - m.at(0,1) ) * recip;
<a name="l00549"></a>00549         }
<a name="l00550"></a>00550         <span class="keywordflow">else</span>
<a name="l00551"></a>00551         {
<a name="l00552"></a>00552             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
<a name="l00553"></a>00553             <span class="keywordflow">if</span>( m.at(1,1) &gt; m.at(0,0) )
<a name="l00554"></a>00554                 i = 1;
<a name="l00555"></a>00555             <span class="keywordflow">if</span>( m.at(2,2) &gt; m.at(i,i) )
<a name="l00556"></a>00556                 i = 2;
<a name="l00557"></a>00557             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = ( i + 1 ) % 3;
<a name="l00558"></a>00558             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = ( j + 1 ) % 3;
<a name="l00559"></a>00559             T s = <a class="code" href="structcinder_1_1math.html">math&lt;T&gt;::sqrt</a>( m.at(i,i) - m.at(j,j) - m.at(k,k) + (T)1.0 );
<a name="l00560"></a>00560             (*this)[i] = (T)0.5 * s;
<a name="l00561"></a>00561             T recip = (T)0.5 / s;
<a name="l00562"></a>00562             <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = ( m.at(k,j) - m.at(j,k) ) * recip;
<a name="l00563"></a>00563             (*this)[j] = ( m.at(j,i) + m.at(i,j) ) * recip;
<a name="l00564"></a>00564             (*this)[k] = ( m.at(k,i) + m.at(i,k) ) * recip;
<a name="l00565"></a>00565         }
<a name="l00566"></a>00566     }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <span class="comment">// Operators</span>
<a name="l00569"></a><a class="code" href="classcinder_1_1_quaternion.html#ad89f60bffc131cdc7a435a85e96379ba">00569</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; <a class="code" href="classcinder_1_1_quaternion.html#ad89f60bffc131cdc7a435a85e96379ba">operator=</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;rhs )
<a name="l00570"></a>00570     {
<a name="l00571"></a>00571         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>;
<a name="l00572"></a>00572         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00573"></a>00573         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00574"></a>00574     }
<a name="l00575"></a>00575 
<a name="l00576"></a>00576     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> FromT&gt;
<a name="l00577"></a><a class="code" href="classcinder_1_1_quaternion.html#af037af2eb9e53c3990f53fc4abc2bfa2">00577</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; <a class="code" href="classcinder_1_1_quaternion.html#ad89f60bffc131cdc7a435a85e96379ba">operator=</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;FromT&gt;</a> &amp;rhs )
<a name="l00578"></a>00578     {
<a name="l00579"></a>00579         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>;
<a name="l00580"></a>00580         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>( rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> );
<a name="l00581"></a>00581         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00582"></a>00582     }
<a name="l00583"></a>00583 
<a name="l00584"></a><a class="code" href="classcinder_1_1_quaternion.html#aa72d4d259f24b0c19347d96ec12756cd">00584</a>     <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#aa72d4d259f24b0c19347d96ec12756cd">operator+</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;rhs )<span class="keyword"> const</span>
<a name="l00585"></a>00585 <span class="keyword">    </span>{
<a name="l00586"></a>00586         <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; lhs = *<span class="keyword">this</span>;
<a name="l00587"></a>00587         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>( lhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>, lhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x, lhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y, lhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z );  
<a name="l00588"></a>00588     }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590     <span class="comment">// post-multiply operator, similar to matrices, but different from Shoemake</span>
<a name="l00591"></a>00591     <span class="comment">// Concatenates &#39;rhs&#39; onto &#39;this&#39;</span>
<a name="l00592"></a><a class="code" href="classcinder_1_1_quaternion.html#a3a749a2f90af3a8dae0858c5d7aff22f">00592</a>     <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a3a749a2f90af3a8dae0858c5d7aff22f">operator*</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;rhs )<span class="keyword"> const</span>
<a name="l00593"></a>00593 <span class="keyword">    </span>{
<a name="l00594"></a>00594         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>( rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z,
<a name="l00595"></a>00595                    rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y,
<a name="l00596"></a>00596                    rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z,
<a name="l00597"></a>00597                    rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z*<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> + rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y*<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x );
<a name="l00598"></a>00598     }
<a name="l00599"></a>00599 
<a name="l00600"></a><a class="code" href="classcinder_1_1_quaternion.html#ae542dc2faeceea1efe9d36c4cfc38964">00600</a>     <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a3a749a2f90af3a8dae0858c5d7aff22f">operator*</a>( T rhs )<span class="keyword"> const </span>
<a name="l00601"></a>00601 <span class="keyword">    </span>{ 
<a name="l00602"></a>00602         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>( <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> * rhs, <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * rhs, <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * rhs, <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * rhs );
<a name="l00603"></a>00603     }
<a name="l00604"></a>00604 
<a name="l00605"></a>00605     <span class="comment">// transform a vector by the quaternion</span>
<a name="l00606"></a><a class="code" href="classcinder_1_1_quaternion.html#a2ffed065410d440c0453f084b3a1e42b">00606</a>     <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a3a749a2f90af3a8dae0858c5d7aff22f">operator*</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;vec )
<a name="l00607"></a>00607     {
<a name="l00608"></a>00608         T vMult = T( 2 ) * ( <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * vec.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * vec.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> + <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * vec.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> );
<a name="l00609"></a>00609         T crossMult = T( 2 ) * <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00610"></a>00610         T pMult = crossMult * <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> - T( 1 );
<a name="l00611"></a>00611 
<a name="l00612"></a>00612         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>( pMult * vec.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> + vMult * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x + crossMult * ( <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * vec.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> - <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * vec.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> ),
<a name="l00613"></a>00613                         pMult * vec.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> + vMult * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + crossMult * ( <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * vec.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> - <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * vec.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> ),
<a name="l00614"></a>00614                         pMult * vec.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> + vMult * <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z + crossMult * ( <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * vec.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> - <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * vec.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> ) );
<a name="l00615"></a>00615     }
<a name="l00616"></a>00616 
<a name="l00617"></a><a class="code" href="classcinder_1_1_quaternion.html#aad27e20f500fac18b72b69d875dea395">00617</a>     <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#aad27e20f500fac18b72b69d875dea395">operator-</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;rhs )<span class="keyword"> const</span>
<a name="l00618"></a>00618 <span class="keyword">    </span>{
<a name="l00619"></a>00619         <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; lhs = *<span class="keyword">this</span>;
<a name="l00620"></a>00620         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>( lhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> - rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>, lhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x, lhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y, lhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z - rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z );
<a name="l00621"></a>00621     }
<a name="l00622"></a>00622 
<a name="l00623"></a><a class="code" href="classcinder_1_1_quaternion.html#ab94d3c2c3e6b4dfde22a49127636e38a">00623</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; <a class="code" href="classcinder_1_1_quaternion.html#ab94d3c2c3e6b4dfde22a49127636e38a">operator+=</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;rhs )
<a name="l00624"></a>00624     {
<a name="l00625"></a>00625         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> += rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00626"></a>00626         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> += rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>;
<a name="l00627"></a>00627         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00628"></a>00628     }
<a name="l00629"></a>00629 
<a name="l00630"></a><a class="code" href="classcinder_1_1_quaternion.html#acf6801da0fdd899fd2cd1a63a6399b93">00630</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; <a class="code" href="classcinder_1_1_quaternion.html#acf6801da0fdd899fd2cd1a63a6399b93">operator-=</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; rhs )
<a name="l00631"></a>00631     {
<a name="l00632"></a>00632         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> -= rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00633"></a>00633         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> -= rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>;
<a name="l00634"></a>00634         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636 
<a name="l00637"></a><a class="code" href="classcinder_1_1_quaternion.html#a2bd616151a18af5c20f503152f2dea67">00637</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; <a class="code" href="classcinder_1_1_quaternion.html#a2bd616151a18af5c20f503152f2dea67">operator*=</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;rhs )
<a name="l00638"></a>00638     {
<a name="l00639"></a>00639         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion</a> q = (*this) * rhs;
<a name="l00640"></a>00640         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> = q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>;
<a name="l00641"></a>00641         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> = q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00642"></a>00642         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00643"></a>00643     }
<a name="l00644"></a>00644 
<a name="l00645"></a><a class="code" href="classcinder_1_1_quaternion.html#a36132a1e099899da9a0818c4a1b8e0fa">00645</a>     <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; <a class="code" href="classcinder_1_1_quaternion.html#a2bd616151a18af5c20f503152f2dea67">operator*=</a>( T rhs )
<a name="l00646"></a>00646     {
<a name="l00647"></a>00647         <a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> *= rhs;
<a name="l00648"></a>00648         <a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> *= rhs;
<a name="l00649"></a>00649         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651 
<a name="l00652"></a><a class="code" href="classcinder_1_1_quaternion.html#a5f461066f0ceb63027c0cb064973d0e4">00652</a>     <span class="keywordtype">bool</span> <a class="code" href="classcinder_1_1_quaternion.html#a5f461066f0ceb63027c0cb064973d0e4">operator==</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;rhs )<span class="keyword"> const</span>
<a name="l00653"></a>00653 <span class="keyword">    </span>{
<a name="l00654"></a>00654         <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a>&amp; lhs = *<span class="keyword">this</span>;
<a name="l00655"></a>00655         <span class="keywordflow">return</span> ( std::fabs(lhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> - rhs.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>) &lt; EPSILON ) &amp;&amp; lhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a> == rhs.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>;
<a name="l00656"></a>00656     }
<a name="l00657"></a>00657 
<a name="l00658"></a><a class="code" href="classcinder_1_1_quaternion.html#ae7e5ff21199a266da99f14f0e62777b1">00658</a>     <span class="keywordtype">bool</span> <a class="code" href="classcinder_1_1_quaternion.html#ae7e5ff21199a266da99f14f0e62777b1">operator!=</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;rhs )<span class="keyword"> const</span>
<a name="l00659"></a>00659 <span class="keyword">    </span>{
<a name="l00660"></a>00660         <span class="keywordflow">return</span> ! (*<span class="keyword">this</span> == rhs);
<a name="l00661"></a>00661     }
<a name="l00662"></a>00662 
<a name="l00663"></a><a class="code" href="classcinder_1_1_quaternion.html#a9b99a700317b7846e1cc8709012db69d">00663</a>     <span class="keyword">inline</span> T&amp; <a class="code" href="classcinder_1_1_quaternion.html#a9b99a700317b7846e1cc8709012db69d">operator[]</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i ) { <span class="keywordflow">return</span> (&amp;<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x)[i]; }
<a name="l00664"></a><a class="code" href="classcinder_1_1_quaternion.html#a2fc7eb13b7350f1b18b7934d01c22d89">00664</a>     <span class="keyword">inline</span> <span class="keyword">const</span> T&amp; <a class="code" href="classcinder_1_1_quaternion.html#a2fc7eb13b7350f1b18b7934d01c22d89">operator[]</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (&amp;<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x)[i]; }
<a name="l00665"></a>00665 
<a name="l00666"></a><a class="code" href="classcinder_1_1_quaternion.html#a65ae2e7c464c737f03ce6b280ad6a22e">00666</a>     <span class="keyword">static</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> <a class="code" href="classcinder_1_1_quaternion.html#a65ae2e7c464c737f03ce6b280ad6a22e">identity</a>()
<a name="l00667"></a>00667     {
<a name="l00668"></a>00668         <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_quaternion.html#a6ba7cef405bde4bc871c809957bbfae9">Quaternion</a>();
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671     <span class="comment">// Output</span>
<a name="l00672"></a><a class="code" href="classcinder_1_1_quaternion.html#a871c9e237d4b87d722a3e6495f377c23">00672</a>     <span class="keyword">friend</span> std::ostream&amp; operator &lt;&lt;( std::ostream &amp;oss, const Quaternion&lt;T&gt; &amp;q )
<a name="l00673"></a>00673     {
<a name="l00674"></a>00674         oss &lt;&lt; q.getAxis() &lt;&lt; <span class="stringliteral">&quot; @ &quot;</span> &lt;&lt; q.getAngle() * ( (T)180 / M_PI ) &lt;&lt; <span class="stringliteral">&quot;deg&quot;</span>;
<a name="l00675"></a>00675         <span class="keywordflow">return</span> oss;
<a name="l00676"></a>00676     }
<a name="l00677"></a>00677 
<a name="l00678"></a>00678  <span class="keyword">private</span>:
<a name="l00679"></a>00679     <span class="comment">// From advanced Animation and Rendering</span>
<a name="l00680"></a>00680     <span class="comment">// Techniques by Watt and Watt, Page 366:</span>
<a name="l00681"></a>00681     <span class="comment">// computing the inner quadrangle </span>
<a name="l00682"></a>00682     <span class="comment">// points (qa and qb) to guarantee tangent</span>
<a name="l00683"></a>00683     <span class="comment">// continuity.</span>
<a name="l00684"></a>00684     <span class="keyword">static</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> splineIntermediate( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q0, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q1, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q2 )
<a name="l00685"></a>00685     {
<a name="l00686"></a>00686         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> q1inv = q1.<a class="code" href="classcinder_1_1_quaternion.html#ab6b4fe4262fea74f528a08c47fdb5b49">inverted</a>();
<a name="l00687"></a>00687         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> c1 = q1inv * q2;
<a name="l00688"></a>00688         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> c2 = q1inv * q0;
<a name="l00689"></a>00689         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> c3 = ( c2.<a class="code" href="classcinder_1_1_quaternion.html#ac9d43961371a5c3be27482c1fd090908">log</a>() + c1.<a class="code" href="classcinder_1_1_quaternion.html#ac9d43961371a5c3be27482c1fd090908">log</a>() ) * (T)-0.25;
<a name="l00690"></a>00690         <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> qa = q1 * c3.<a class="code" href="classcinder_1_1_quaternion.html#a9dd8b284d61115ab48316c0bc91e6020">exp</a>();
<a name="l00691"></a>00691         <span class="keywordflow">return</span> qa.<a class="code" href="classcinder_1_1_quaternion.html#ae8321a260b782e5605e153667c523d45">normalized</a>();
<a name="l00692"></a>00692     }
<a name="l00693"></a>00693 };
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
<a name="l00696"></a><a class="code" href="namespacecinder.html#ae77bf4ff77823f2b988d4415c2ee4308">00696</a> <span class="keyword">inline</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> <a class="code" href="namespacecinder.html#ae77bf4ff77823f2b988d4415c2ee4308">operator*</a>( <span class="keyword">const</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a> &amp;vec, <span class="keyword">const</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;T&gt;</a> &amp;q )
<a name="l00697"></a>00697 {
<a name="l00698"></a>00698     T vMult = T( 2 ) * ( q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * vec.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> + q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * vec.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> + q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * vec.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> );
<a name="l00699"></a>00699     T crossMult = T( 2 ) * q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a>;
<a name="l00700"></a>00700     T pMult = crossMult * q.<a class="code" href="classcinder_1_1_quaternion.html#adb814935bfb92eda5c6445cdb35295cc">w</a> - T( 1 );
<a name="l00701"></a>00701 
<a name="l00702"></a>00702     <span class="keywordflow">return</span> <a class="code" href="classcinder_1_1_vec3.html">Vec3&lt;T&gt;</a>( pMult * vec.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> + vMult * q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x + crossMult * ( q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * vec.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * vec.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> ),
<a name="l00703"></a>00703                     pMult * vec.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> + vMult * q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y + crossMult * ( q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z * vec.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * vec.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> ),
<a name="l00704"></a>00704                     pMult * vec.<a class="code" href="classcinder_1_1_vec3.html#a1898e23b728500d7debf242fc84c1cc5">z</a> + vMult * q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.z + crossMult * ( q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.x * vec.<a class="code" href="classcinder_1_1_vec3.html#a1cdeedcdf989bf535c1c946cda6a9aa9">y</a> - q.<a class="code" href="classcinder_1_1_quaternion.html#a98e9e184b0d00472e1b338d9697fda1e">v</a>.y * vec.<a class="code" href="classcinder_1_1_vec3.html#afe9290afba72d916e9a9151f20135ffa">x</a> ) );
<a name="l00705"></a>00705 }
<a name="l00706"></a>00706 
<a name="l00707"></a><a class="code" href="namespacecinder.html#aebe7d270f96a07df222b9870e3220cbd">00707</a> <span class="keyword">typedef</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;float&gt;</a>   <a class="code" href="classcinder_1_1_quaternion.html">Quatf</a>;
<a name="l00708"></a><a class="code" href="namespacecinder.html#a2511d8bb18da71aca56c9af0a7d71b57">00708</a> <span class="keyword">typedef</span> <a class="code" href="classcinder_1_1_quaternion.html">Quaternion&lt;double&gt;</a>  <a class="code" href="classcinder_1_1_quaternion.html">Quatd</a>;
<a name="l00709"></a>00709 
<a name="l00710"></a>00710 } <span class="comment">// namespace cinder</span>
</pre></div></div>
</div>
	<div class="footer">
		<p> </p>
	</div>
</div>	
</body>
</html>
